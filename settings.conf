# ============================================
# ‚öôÔ∏è Telegrep Configuration File (R‚Ä¢otServ)
# ============================================
# –í–µ—Ä—Å–∏—è: 1.1 (29.10.2025)
# –ê–≤—Ç–æ—Ä: Denjik ¬© 2025
# –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –†–∞—Å—Å—ã–ª–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö –ª–æ–≥–æ–≤ –≤ Telegram —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º

# ============================================
# üîë TELEGRAM –ù–ê–°–¢–†–û–ô–ö–ò
# ============================================

token="1234567890:AAAA-AaAA1aaAAAAAAaaaAAaAAAA"
chat_id="id"

# ============================================
# üéØ –§–ò–õ–¨–¢–†–ê–¶–ò–Ø –õ–û–ì–û–í
# ============================================

# –û—Å–Ω–æ–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è, –∑–∞ –∫–æ—Ç–æ—Ä—ã–º–∏ –Ω—É–∂–Ω–æ —Å–ª–µ–¥–∏—Ç—å:
# - –∫–æ–º–∞–Ω–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (HISTORY)
# - root –¥–µ–π—Å—Ç–≤–∏—è
# - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ ssh
# - docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
# - —Å–∏—Å—Ç–µ–º–Ω—ã–µ kernel-—Å–æ–±—ã—Ç–∏—è
# - –æ—à–∏–±–∫–∏ –∏ —Å–±–æ–∏
#
# ‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:
#   –°–æ–±—ã—Ç–∏—è HISTORY –ø–æ—è–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ bash —Å–æ–±—Ä–∞–Ω —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏—è.
#   –ù–∞–ø—Ä–∏–º–µ—Ä:
#     - loggerbash (Gentoo)
#     - sudolog –∏–ª–∏ bash-logger (Ubuntu, Debian)
#   –ï—Å–ª–∏ –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ—Ç, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ ~/.bashrc —Å—Ç—Ä–æ–∫—É:
#     trap 'logger "HISTORY: PID=$$ UID=$UID CMD=$(history 1 | sed \"s/^[ ]*[0-9]\+[ ]*//\")"' DEBUG

pattern="HISTORY:|kernel:|ssh|sshd|docker|su|sudo|error|fail|warn|panic|oom|segfault"

# –ò—Å–∫–ª—é—á–∞–µ–º —Ä—É—Ç–∏–Ω—É ‚Äî systemd, dbus, avahi, —à—É–º–Ω—ã–µ —Å–ª—É–∂–±—ã
exceptions="systemd|dbus|avahi|NetworkManager|cups|pulseaudio|rtkit|colord"

# ============================================
# üìÅ –ü–£–¢–¨ –ö –õ–û–ì-–§–ê–ô–õ–£
# ============================================

log_file="/var/log/messages"

# ============================================
# üé® –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–ï –°–û–û–ë–©–ï–ù–ò–ô (HTML)
# ============================================

# –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è:
# <b>–∂–∏—Ä–Ω—ã–π</b>, <i>–∫—É—Ä—Å–∏–≤</i>, <u>–ø–æ–¥—á—ë—Ä–∫–Ω—É—Ç—ã–π</u>, <code>–∫–æ–¥</code>, <pre>–±–ª–æ–∫</pre>, <tg-spoiler>—Å–ø–æ–π–ª–µ—Ä</tg-spoiler>
# Telegram –ø–æ–Ω–∏–º–∞–µ—Ç HTML, –Ω–µ –Ω—É–∂–Ω–æ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é –≤ –∫–æ–¥–µ.

# –ü—Ä–∏–º–µ—Ä –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è:
# üß† <b>HISTORY EVENT</b>
# <b>PID:</b> <code>3526</code>
# <b>UID:</b> <code>1002</code>
# <b>CMD:</b> <code>screen -x beam7</code>

# –ü—Ä–∏–º–µ—Ä kernel-—Å–æ–æ–±—â–µ–Ω–∏—è:
# ‚öôÔ∏è <b>Kernel:</b> <pre>br-22f605cf4746: port 1(vethb6628fa) entered disabled state</pre>

# –ü—Ä–∏–º–µ—Ä ssh:
# üîê <b>SSH:</b> <code>ssh nina@localhost -p 2222</code>

# –ü—Ä–∏–º–µ—Ä docker:
# üê≥ <b>Docker:</b> <code>docker start openwebrxplus</code>

# ============================================
# ‚ö° –†–ï–ñ–ò–ú–´ (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û)
# ============================================

# –í–∫–ª—é—á–∏—Ç—å –æ—Ç–ª–∞–¥–∫—É (y/n)
DEB="n"

# –í–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (y/n)
LOG="n"

# ============================================
# üí° –†–ï–ö–û–ú–ï–ù–î–û–í–ê–ù–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò –î–õ–Ø –¢–í–û–ï–ì–û –°–õ–£–ß–ê–Ø
# ============================================

# ‚¨õ –ü—Ä–∏–º–µ—Ä: –æ–±—ã—á–Ω—ã–π —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å
#   –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
#pattern="HISTORY:|ssh|sshd|su|sudo|docker|kernel:|error|fail|warn"
#exceptions="systemd|dbus|avahi"

# üü• –ü—Ä–∏–º–µ—Ä: —Ä–µ–∂–∏–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
#   –¢–æ–ª—å–∫–æ root/ssh –∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
#pattern="HISTORY:.*UID=0|ssh|su|sudo|fail|unauthorized"
#exceptions=""

# üü© –ü—Ä–∏–º–µ—Ä: —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
#   –¢–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥—ã HISTORY –∏ –æ—à–∏–±–∫–∏
#pattern="HISTORY:|error|fail"
#exceptions="systemd|dbus"

# ============================================
# üß© –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨
# ============================================

# chmod 600 /opt/telegrep/settings.conf
# chown root:root /opt/telegrep/settings.conf
# ls -l –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å: -rw------- 1 root root settings.conf

# ============================================
# üß† –ü–û–õ–ï–ó–ù–´–ï –ö–û–ú–ê–ù–î–´
# ============================================

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å:
#   rc-service telegrep checkconfig

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å:
#   rc-service telegrep restart

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å:
#   rc-service telegrep status

# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç:
#   logger "HISTORY: PID=9999 UID=0 echo test"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ç–æ–∫ –ª–æ–≥–æ–≤:
#   tail -f /var/log/messages | grep telegrep

# ============================================
# üì° –ò–ù–§–û
# ============================================

# –ü—Ä–æ–µ–∫—Ç: https://github.com/PEAKT0P/
# Powered by: www.denjik.ru
# Assistant: ChatGPT (GPT-5)

